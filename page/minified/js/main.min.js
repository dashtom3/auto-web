var app=angular.module("auto-biz-user",["ngRoute","bw.paging","ngFileUpload"]);app.config(["$locationProvider","$httpProvider","$routeProvider",function(e,t,n){console.log("载入angular config"),n.when("/",{templateUrl:"/page/project/html/views/user/innovation.html"}).when("/innovation",{templateUrl:"/page/project/html/views/user/innovation.html"}).when("/innovation/:name",{templateUrl:"/page/project/html/views/user/innovation.html"}).when("/registerCompany",{templateUrl:"/page/project/html/views/user/companyCreate.html"}).when("/registerUser",{templateUrl:"/page/project/html/views/user/userRegister.html"}).when("/loginUser",{templateUrl:"/page/project/html/views/user/userLogin.html"}).when("/loginCompany",{templateUrl:"/page/project/html/views/user/companyLogin.html"}).when("/companyInfo/:id",{templateUrl:"/page/project/html/views/user/companyDetail.html"}).when("/companyInfo/:id/:name",{templateUrl:"/page/project/html/views/user/companyDetail.html"}).when("/companyNews/:id",{templateUrl:"/page/project/html/views/user/companyNewsDetail.html"}).when("/company",{templateUrl:"/page/project/html/views/company/company.html"}).when("/adminPage",{templateUrl:"/page/project/html/views/admin/admin.html",controller:"AdminController"}).when("/admin",{templateUrl:"/page/project/html/views/admin/adminLogin.html"}).when("/companyProduct/:id",{templateUrl:"/page/project/html/views/user/companyProductDetail.html"}),e.html5Mode(!0),t.interceptors.push("loadingHttpInterceptor")}]),app.run(["AuthService","$rootScope",function(e,t){console.log("获取本地数据"),e.setInfoFromLocalStorage()}]),window.alert=function(e){var t=document.createElement("DIV");t.id="shield",t.style.position="absolute",t.style.left="0px",t.style.top="0px",t.style.width="100%",t.style.height=document.body.offsetHeight+"px",t.style.background="rgba(14,31,71,0.25)",t.style.textAlign="center",t.style.zIndex="25";var n=document.createElement("DIV");n.id="alertFram",n.style.position="fixed",n.style.left="50%",n.style.top="50%",n.style.marginLeft="-155px",n.style.marginTop="-64px",n.style.width="310px",n.style.height="128px",n.style.textAlign="center",n.style.zIndex="300",n.style.background="white",strHtml='<ul class="modal-middle">\n',strHtml+=' <li class="modal-top"></li>\n',strHtml+=' <li class="modal-content2"><img src="/page/project/images/company/warn.png">'+e+"</li>\n",strHtml+=' <li class="modal-def1"><input class="inp1" type="button" value="取消" onclick="doOk()" /></li>\n',strHtml+=' <li class="modal-def2"><input class="inp2" type="button" value="确定" onclick="doOk()" /></li>\n',strHtml+="</ul>\n",n.innerHTML=strHtml,document.body.appendChild(n),document.body.appendChild(t),this.doOk=function(){n.style.display="none",t.style.display="none"},n.focus(),document.body.onselectstart=function(){return!1}},angular.module("auto-biz-user").directive("mycarousel",function(){return{templateUrl:"/page/project/html/template/user/carousel.html",scope:{imageList:"="},controller:function(e,t,n){e.imageList=e.imageList},restrict:"E",link:function(e,t,n,o){function r(){e.imgList=[];for(i in e.imageList){var t=new Object;t.url=e.imageList[i],t.num=i,e.imgList.push(t)}e.currentCarouse=e.imgList[0].num}e.setCurrentCarouse=function(t){e.currentCarouse=t},e.moveLeft=function(){console.log(e.currentCarouse),"0"==e.currentCarouse?e.currentCarouse=e.imgList.length-1:e.currentCarouse--},e.moveRight=function(){console.log(e.currentCarouse),e.currentCarouse==e.imgList.length-1?e.currentCarouse=0:e.currentCarouse++},e.$watch("imageList",function(t,n){e.imageList&&e.imageList.length>0&&r()},!0)}}}),angular.module("auto-biz-user").directive("HeaderCollapse",function(){return{restrict:"A",link:function(e,t){var n=t.find("ul"),o=t.find("a");t.mouseenter(function(){n.stop().show(300),t.css("border-top","solid 5px #ed4f28"),o.css("margin-left","-1px"),o.css("margin-right","-1px"),o.css("padding-bottom","11px"),o.css("border-left","solid 1px #cccccc"),o.css("border-right","solid 1px #cccccc")}),t.mouseleave(function(){n.stop().hide(300),t.css("border","none"),t.css("margin-bottom","0px"),o.css("border","none"),o.css("padding-bottom","15px")})}}}),angular.module("auto-biz-user").directive("ueditor",["$timeout",function(e){return{restrict:"E",require:"ngModel",link:function(e,t,n,o){var r="ueditor_"+Date.now();t[0].id=r;var a=UE.getEditor(r,{initialFrameWidth:"100%",initialFrameHeight:"200",autoHeightEnabled:!0});o.$render=function(){try{a.setContent(o.$modelValue)}catch(e){}},a.ready(function(){a.addListener("contentChange",function(){o.$setViewValue(a.getContent()),e.$$phase||e.$apply()})})}}}]),angular.module("auto-biz-user").filter("companyTypeFilter",function(){return function(e){return"CM"==e?"汽车制造":"CG"==e?"汽车零部件":"CS"==e?"汽车销售与服务":"NEC"==e?"新能源汽车":"NOC"==e?"车联网":"CC"==e?"车用化工品":"CE"==e?"汽车金融":"PT"==e?"公共交通":"MOC"==e?"汽车媒体":"未知"}}),angular.module("auto-biz-user").filter("dateFilter",function(){return function(e){return new Date(parseInt(e)).toLocaleDateString()}}),angular.module("auto-biz-user").filter("dayFilter",function(){return function(e){return new Date(parseInt(e)).getDate()}}),angular.module("auto-biz-user").filter("yearFilter",function(){return function(e){var t=new Date(parseInt(e));return t.getFullYear()+"/"+t.getMonth()}}),angular.module("auto-biz-user").filter("DataFilter",function(){return function(e){return console.log("载入过滤器dataFilter"),e}}),angular.module("auto-biz-user").filter("imageFilter",function(){return function(e){return"http://123.56.220.72:3300/image/"+e}}),angular.module("auto-biz-user").filter("statusFilter",function(){return function(e){return"1"==e?"已通过":"0"==e?"待审核":"-1"==e?"未通过":"错误"}}),angular.module("auto-biz-user").filter("statusFilter2",function(){return function(e){return e?"上线":"下线"}}),angular.module("auto-biz-user").filter("yesOrNoFilter",function(){return function(e){return e?"是":"否"}}),angular.module("auto-biz-user").filter("productFilter",function(){return function(e){return e?"展示中":"隐藏中"}}),angular.module("auto-biz-user").filter("statusFilter3",function(){return function(e){return e?"✓":"✘"}}),angular.module("auto-biz-user").filter("trustHtmlFilter",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}]),angular.module("auto-biz-user").filter("newsFirstFilter",function(){return function(e){return 1==e?"原创":"摘抄"}}),angular.module("auto-biz-user").filter("avePointFilter",function(){return function(e){for(var t=0,n=0;n<e.length;n++)t+=parseFloat(e[n]);return t/e.length}}),angular.module("auto-biz-user").filter("needInvestFilter",function(){return function(e){return 1==e?"有投融资需求":"暂无投融资需求"}}),angular.module("auto-biz-user").filter("countFilter",function(){return function(e){return null==e?0:e.length}}),angular.module("auto-biz-user").filter("typeFilter",function(){return function(e){return"normal"==e?"普通用户":"vc"==e?"投资人":"wr"==e?"作家":"admin"==e?"管理员":"黑名单"}}),angular.module("auto-biz-user").filter("testTypeFilter",function(){return function(e){return e?"local":e?"未知":"mail"}}),angular.module("auto-biz-user").filter("userTestTypeFilter",function(){return function(e){return"local"==e?"实地":"mail"==e?"邮寄":"未知"}}),angular.module("auto-biz-user").service("AuthService",["$q","$http","GlobalService",function(e,t,n){var o=this;this.userLogin=function(r,a){var i=e.defer();return t.get(n.baseUrl+"user/login?name="+r+"&password="+n.MD5Decode(a)).success(function(e){"SUCCEED"==e.callStatus?(o.kickOut(),o.user=e.data,localStorage.auto_user=JSON.stringify(e.data),console.log("用户登录"),i.resolve(e.data)):alert("用户名密码错误")}).error(function(e){alert("您好，您访问的内容出错")}),i.promise},this.kickOut=function(){o.user&&(o.user=null,localStorage.auto_user=null),o.company&&(o.company=null,localStorage.auto_company=null)},this.userLogout=function(){var r=e.defer();return t.get(n.baseUrl+"user/logout?token="+o.user.token).success(function(e){"SUCCEED"==e.callStatus?(console.log("用户登出"),localStorage.auto_user=null,r.resolve()):alert("您好，用户登出失败")}).error(function(e){alert("您好，您访问的内容出错")}),r.promise},this.companyLogin=function(r,a){var i=e.defer();return t.get(n.baseUrl+"company/login?name="+r+"&password="+a).success(function(e){"SUCCEED"==e.callStatus?(o.kickOut(),console.log("企业登录"),o.company=e.data,localStorage.auto_company=JSON.stringify(e.data),i.resolve(e.data)):alert("用户名密码错误")}).error(function(e){alert("您好，您访问的内容出错")}),i.promise},this.companyLogout=function(){var r=e.defer();return t.get(n.baseUrl+"company/logout?token="+o.company.token).success(function(e){"SUCCEED"==e.callStatus?(console.log("企业登出"),localStorage.auto_company=null,r.resolve()):alert("您好，企业登出失败")}).error(function(e){alert("您好，您访问的内容出错")}),r.promise},this.setUserInfo=function(e){o.user=e,o.token=e.token},this.setCompanyInfo=function(e){o.company=e,o.token=e.token},this.getToken=function(){return o.user?o.user.token:o.company?o.company.token:"guest"},this.setInfoFromLocalStorage=function(){null!=localStorage.auto_user&&(o.user=JSON.parse(localStorage.auto_user)),null!=localStorage.auto_company&&(o.company=JSON.parse(localStorage.auto_company))}}]),angular.module("auto-biz-user").service("CompanyFinanceService",["$http","GlobalService","$q","AuthService",function(e,t,n,o){this.getCompanyFinanceList=function(o,r,a,i,s){var c=n.defer(),l=t.getURLStr([["companyId",o],["yearStart",r],["yearEnd",a]]);return e.get(t.baseUrl+"finance/list/"+i+"/"+s+"?"+l).success(function(e){console.log("获取企业财务列表"),"SUCCEED"==e.callStatus?c.resolve(e.data):alert("获取失败")}).error(function(e){alert("您好，您访问的内容出错")}),c.promise},this.deleteCompanyFinance=function(r){var a=n.defer(),i=t.getURLStr([["financeRecordId",r],["token",o.getToken()]]);return e.get(t.baseUrl+"finance/delete?"+i).success(function(e){console.log("删除企业财务"),"SUCCEED"==e.callStatus?a.resolve(e.data):alert("删除失败")}).error(function(e){alert("您好，您访问的内容出错")}),a.promise},this.modifyCompanyFinance=function(r){var a=n.defer(),i=t.getURLStr([["financeRecordId",r._id],["year",r.year],["ratio",r.ratio],["input",r.input],["increase",r.increase],["allCapital",r.allCapital],["realCapital",r.realCapital],["allRatio",r.allRatio],["realRatio",r.realRatio],["debtRatio",r.debtRatio],["inputRatio",r.inputRatio],["token",o.getToken()]]);return e.get(t.baseUrl+"finance/modify?"+i).success(function(e){console.log("修改企业财务"),"SUCCEED"==e.callStatus?a.resolve(e.data):alert("修改失败")}).error(function(e){alert("您好，您访问的内容出错")}),a.promise},this.addCompanyFinance=function(r){r.token=o.getToken();var a=n.defer();return e.post(t.baseUrl+"finance/add",r).success(function(e){console.log("添加财务"),"SUCCEED"==e.callStatus?a.resolve(e.data):alert("添加失败")}).error(function(e){alert("您好，您访问的内容出错")}),a.promise},this.updateCompanyFinance=function(r){r.token=o.getToken(),console.log(r);var a=n.defer();return e.post(t.baseUrl+"finance/modify",r).success(function(e){console.log("修改财务数据"),"SUCCEED"==e.callStatus?a.resolve(e.data):alert("修改失败")}).error(function(e){alert("您好，您访问的内容出错")}),a.promise}}]),angular.module("auto-biz-user").service("CompanyNewsService",["$http","GlobalService","$q","AuthService",function(e,t,n,o){this.getCompanyNewsList=function(o,r,a,i,s,c,l,u,p,m){var d=n.defer(),g=t.getURLStr([["title",o],["author",r],["isFirst",a],["tag",i],["isOnline",s],["companyId",c],["startTime",l],["endTime",u]]),f=t.baseUrl+"news/list/"+p+"/"+m+"?"+g;return console.log(f),e.get(f).success(function(e){console.log("获取企业新闻列表"),console.log(e),"SUCCEED"==e.callStatus?d.resolve(e.data):alert("您好，您访问的内容出错")}).error(function(e){alert("您好，您访问的内容出错")}),d.promise},this.getCompanyNewsDetail=function(o){var r=n.defer();return e.get(t.baseUrl+"news/detail?newsId="+o).success(function(e){console.log("获取企业新闻详情"),"SUCCEED"==e.callStatus?r.resolve(e.data):alert("您好，您访问的内容出错")}).error(function(e){alert("您好，您访问的内容出错")}),r.promise},this.changeCompanyNewsState=function(r,a){var i=n.defer();a=""+a;var s=t.getURLStr([["newsId",r],["isOnline",a],["token",o.getToken()]]);return e.get(t.baseUrl+"news/modify/online?"+s).success(function(e){console.log("改变新闻状态"),"SUCCEED"==e.callStatus?i.resolve(e.data):alert("您好，您访问的内容出错")}).error(function(e){alert("您好，您访问的内容出错")}),i.promise},this.changeCompanyNewsStateAdmin=function(r,a){var i=n.defer();a=""+a;var s=t.getURLStr([["newsId",r],["isOnline",a],["token",o.getToken()]]);return e.get(t.baseUrl+"news/modify/online/admin?"+s).success(function(e){console.log("改变新闻状态"),"SUCCEED"==e.callStatus?i.resolve(e.data):alert("您好，您访问的内容出错")}).error(function(e){alert("您好，您访问的内容出错")}),i.promise},this.deleteCompanyNews=function(r){var a=n.defer(),i=t.getURLStr([["newsId",r],["token",o.getToken()]]);return e.get(t.baseUrl+"news/delete?"+i).success(function(e){console.log("删除企业资讯"),"SUCCEED"==e.callStatus?a.resolve(e.data):alert("删除失败")}).error(function(e){alert("您好，您访问的内容出错")}),a.promise},this.addCompanyNews=function(r){r.token=o.getToken(),console.log(r.token);var a=n.defer();return e.post(t.baseUrl+"news/add",r).success(function(e){console.log("添加企业资讯"),"SUCCEED"==e.callStatus?a.resolve(e.data):alert("添加失败")}).error(function(e){alert("您好，您访问的内容出错")}),a.promise},this.updateCompanyNews=function(r){r.token=o.getToken(),r.newsId=r._id;var a=n.defer();return e.post(t.baseUrl+"news/modify/detail",r).success(function(e){console.log("修改资讯数据"),"SUCCEED"==e.callStatus?a.resolve(e.data):alert("修改失败")}).error(function(e){alert("您好，您访问的内容出错")}),a.promise}}]),angular.module("auto-biz-user").service("CompanyPriReportService",["$http","GlobalService","$q","AuthService",function(e,t,n,o){this.getCompanyPriReportList=function(o,r,a,i,s,c,l,u,p,m,d,g,f,y,C,h,v,P,L){var S=n.defer();console.log(l),console.log(u);var T=t.getURLStr([["productId",o],["title",r],["type",a],["address",i],["startDateStart",s],["endDateStart",c],["startDateEnd",l],["endDateEnd",u],["maxUserNum_Min",p],["maxUserNum_Max",m],["argc",d],["state",g],["signUser",f],["passUser",y],["startTime",C],["endTime",h],["companyId",v]]),w=t.baseUrl+"report/private/list/"+P+"/"+L+"?"+T;return e.get(w).success(function(e){console.log("获取用户测评列表"),console.log(e),"SUCCEED"==e.callStatus?S.resolve(e.data):alert("您好，您访问的内容出错")}).error(function(e){alert("您好，您访问的内容出错")}),S.promise},this.changeCompanyPriReportOnline=function(r,a){var i=n.defer(),s=t.getURLStr([["reportId",r],["isOnline",a],["token",o.getToken()]]);return e.get(t.baseUrl+"report/private/modify/online?"+s).success(function(e){console.log("改变测评状态"),"SUCCEED"==e.callStatus?i.resolve(e.data):alert("您好，您访问的内容出错")}).error(function(e){alert("您好，您访问的内容出错")}),i.promise},this.changeCompanyPriReportOnlineAdmin=function(r,a){var i=n.defer(),s=t.getURLStr([["reportId",r],["isOnline",a],["token",o.getToken()]]);return e.get(t.baseUrl+"report/private/modify/online/admin?"+s).success(function(e){console.log("改变测评状态"),"SUCCEED"==e.callStatus?i.resolve(e.data):alert("您好，您访问的内容出错")}).error(function(e){alert("您好，您访问的内容出错")}),i.promise},this.changeCompanyPriReportState=function(r,a){var i=n.defer(),s=t.getURLStr([["reportId",r],["state",a],["token",o.getToken()]]);return e.get(t.baseUrl+"report/private/modify/approval?"+s).success(function(e){console.log("改变测评状态"),"SUCCEED"==e.callStatus?i.resolve(e.data):alert("您好，您访问的内容出错")}).error(function(e){alert("您好，您访问的内容出错")}),i.promise},this.getCompanyPriReportDetail=function(o){var r=n.defer();return e.get(t.baseUrl+"report/private/detail?reportId="+o).success(function(e){console.log("获取用户测评详情"),"SUCCEED"==e.callStatus?r.resolve(e.data):alert("您好，您访问的内容出错")}).error(function(e){alert("您好，您访问的内容出错")}),r.promise},this.getReportSignUser=function(r,a){var i=n.defer(),s=t.getURLStr([["reportId",r],["passed",a],["token",o.getToken()]]);return e.get(t.baseUrl+"report/private/signuser/list?"+s).success(function(e){console.log("获取报名用户"),"SUCCEED"==e.callStatus?i.resolve(e.data):alert("您好，您访问的内容出错")}).error(function(e){alert("您好，您访问的内容出错")}),i.promise},this.getReportPassUser=function(r,a){var i=n.defer(),s=t.getURLStr([["reportId",r],["passed",a],["token",o.getToken()]]);return e.get(t.baseUrl+"report/private/passuser/list?"+s).success(function(e){console.log("获取测评用户用户"),"SUCCEED"==e.callStatus?i.resolve(e.data):alert("您好，您访问的内容出错")}).error(function(e){alert("您好，您访问的内容出错")}),i.promise},this.getCompanyPriReportComment=function(o){var r=n.defer();return e.get(t.baseUrl+"report/private/comment/list?reportId="+o).success(function(e){console.log("获取用户评论"),"SUCCEED"==e.callStatus?r.resolve(e.data):alert("您好，您访问的内容出错")}).error(function(e){alert("您好，您访问的内容出错")}),r.promise},this.deleteCompanyPriReport=function(r){var a=n.defer(),i=t.getURLStr([["reportId",r],["token",o.getToken()]]);return e.get(t.baseUrl+"report/private/delete?"+i).success(function(e){console.log("删除专业测评"),"SUCCEED"==e.callStatus?a.resolve(e.data):alert("删除失败")}).error(function(e){alert("您好，您访问的内容出错")}),a.promise},this.addCompanyPriReport=function(r){r.token=o.getToken();var a=n.defer();return e.post(t.baseUrl+"report/private/add",r).success(function(e){console.log("添加用户测评"),"SUCCEED"==e.callStatus?a.resolve(e.data):"ALREADY_CREATE_PRIVATE_REPORT"==e.errCode?alert("该产品已经有用户测评了"):alert("添加失败")}).error(function(e){alert("您好，您访问的内容出错")}),a.promise},this.updateCompanyPriReport=function(r){r.token=o.getToken();var a=n.defer();return e.post(t.baseUrl+"report/private/modify/detail",r).success(function(e){console.log("修改用户测评"),"SUCCEED"==e.callStatus?a.resolve(e.data):alert("修改失败")}).error(function(e){alert("您好，您访问的内容出错")}),a.promise},this.signCompanyPriReport=function(r,a,i){var s=n.defer(),c=t.getURLStr([["reportId",r],["phone",a],["address",i],["token",o.getToken()]]);return e.get(t.baseUrl+"report/private/sign?"+c).success(function(e){console.log("报名用户测评"),"SUCCEED"==e.callStatus?s.resolve(e.data):"NOT_PASSED"==e.errCode?alert("您的用户审核还未通过"):"ALREADY_SIGNED"==e.errCode?alert("您已经报名过该测评"):alert("报名失败，错误为"+e.errCode)}).error(function(e){alert("您好，您访问的内容出错")}),s.promise},this.passCompanyPriReport=function(r,a,i){var s=n.defer(),c=t.getURLStr([["reportId",r],["userId",a],["passed",i],["token",o.getToken()]]);return e.get(t.baseUrl+"report/private/pass?"+c).success(function(e){console.log("通过用户测评"),"SUCCEED"==e.callStatus?s.resolve(e.data):alert("通过失败")}).error(function(e){alert("您好，您访问的内容出错")}),s.promise},this.commentCompanyPriReport=function(r){r.token=o.getToken();var a=n.defer();return e.post(t.baseUrl+"report/private/comment",r).success(function(e){console.log("通过用户测评"),"SUCCEED"==e.callStatus?a.resolve(e.data):alert("评论失败")}).error(function(e){alert("您好，您不是该测评的用户")}),a.promise},this.passCommentCompanyPriReport=function(r,a,i){var s=n.defer(),c=t.getURLStr([["reportId",r],["userId",a],["passed",i],["token",o.getToken()]]);return e.get(t.baseUrl+"report/private/modify/commentpass?"+c).success(function(e){console.log("通过用户评论"),"SUCCEED"==e.callStatus?s.resolve(e.data):alert(e.errCode)}).error(function(e){alert("您好，您访问的内容出错")}),s.promise}}]),angular.module("auto-biz-user").service("CompanyProductsService",["$http","GlobalService","$q","AuthService",function(e,t,n,o){this.getCompanyProductsList=function(o,r,a,i,s,c,l,u,p,m){var d=n.defer(),g=t.getURLStr([["name",o],["tag",r],["state",a],["argc",i],["desc",s],["companyId",c],["startTime",l],["endTime",u]]),f=t.baseUrl+"product/list/"+p+"/"+m+"?"+g;return e.get(f).success(function(e){console.log("获取企业产品列表"),"SUCCEED"==e.callStatus?d.resolve(e.data):alert("您好，您访问的内容出错")}).error(function(e){alert("您好，您访问的内容出错")}),d.promise},this.getCompanyProductsDetail=function(o){var r=n.defer();return e.get(t.baseUrl+"product/detail?productId="+o).success(function(e){console.log("获取企业产品详情"),"SUCCEED"==e.callStatus?r.resolve(e.data):alert("您好，您访问的内容出错")}).error(function(e){alert("您好，您访问的内容出错")}),r.promise},this.changeCompanyProductsState=function(r,a){var i=n.defer();a=""+a;var s=t.getURLStr([["productId",r],["state",a],["token",o.getToken()]]);return e.get(t.baseUrl+"product/modify/online?"+s).success(function(e){console.log("改变产品状态"),"SUCCEED"==e.callStatus?i.resolve(e.data):alert("您好，您访问的内容出错")}).error(function(e){alert("您好，您访问的内容出错")}),i.promise},this.changeCompanyProductsStateAdmin=function(r,a){var i=n.defer();a=""+a;var s=t.getURLStr([["productId",r],["state",a],["token",o.getToken()]]);return e.get(t.baseUrl+"product/modify/online/admin?"+s).success(function(e){console.log("改变产品状态"),"SUCCEED"==e.callStatus?i.resolve(e.data):alert("您好，您访问的内容出错")}).error(function(e){alert("您好，您访问的内容出错")}),i.promise},this.deleteCompanyProduct=function(r){var a=n.defer(),i=t.getURLStr([["productId",r],["token",o.getToken()]]);return e.get(t.baseUrl+"product/delete?"+i).success(function(e){console.log("删除产品"),"SUCCEED"==e.callStatus?a.resolve(e.data):alert("删除失败")}).error(function(e){alert("您好，您访问的内容出错")}),a.promise},this.addCompanyProduct=function(r){r.token=o.getToken();var a=n.defer();return e.post(t.baseUrl+"product/add",r).success(function(e){console.log("添加产品"),"SUCCEED"==e.callStatus?a.resolve(e.data):alert("添加失败")}).error(function(e){alert("您好，您访问的内容出错")}),a.promise},this.updateCompanyProduct=function(r){r.token=o.getToken(),r.productId=r._id;var a=n.defer();return e.post(t.baseUrl+"product/modify/detail",r).success(function(e){console.log("修改产品"),"SUCCEED"==e.callStatus?a.resolve(e.data):alert("修改失败")}).error(function(e){alert("您好，您访问的内容出错")}),a.promise}}]),angular.module("auto-biz-user").service("CompanyPubReportService",["$http","GlobalService","$q","AuthService",function(e,t,n,o){this.getCompanyPubReportList=function(o,r,a,i,s,c,l,u,p,m){var d=n.defer(),g=t.getURLStr([["productId",o],["isOnline",r],["testDesc",a],["team",i],["site",s],["companyId",c],["dateStart",l],["dateEnd",u]]),f=t.baseUrl+"report/public/list/"+p+"/"+m+"?"+g;return console.log(f),e.get(f).success(function(e){console.log("获取企业专业测评列表"),console.log(e),"SUCCEED"==e.callStatus?d.resolve(e.data):alert("您好，您访问的内容出错")}).error(function(e){alert("您好，您访问的内容出错")}),d.promise},this.changeCompanyPubReportState=function(r,a){var i=n.defer(),s=t.getURLStr([["reportId",r],["isOnline",a],["token",o.getToken()]]);return e.get(t.baseUrl+"report/public/modify/online?"+s).success(function(e){console.log("改变测评状态"),"SUCCEED"==e.callStatus?i.resolve(e.data):alert("您好，您访问的内容出错")}).error(function(e){alert("您好，您访问的内容出错")}),i.promise},this.changeCompanyPubReportStateAdmin=function(r,a){var i=n.defer(),s=t.getURLStr([["reportId",r],["isOnline",a],["token",o.getToken()]]);return e.get(t.baseUrl+"report/public/modify/online/admin?"+s).success(function(e){console.log("改变测评状态"),"SUCCEED"==e.callStatus?i.resolve(e.data):alert("您好，您访问的内容出错")}).error(function(e){alert("您好，您访问的内容出错")}),i.promise},this.getCompanyPubReportDetail=function(o){var r=n.defer();return e.get(t.baseUrl+"report/public/list/1/1?productId="+o).success(function(e){console.log("获取专业测评详情"),"SUCCEED"==e.callStatus?r.resolve(e.data):alert("您好，您访问的内容出错")}).error(function(e){alert("您好，您访问的内容出错")}),r.promise},this.deleteCompanyPubReport=function(r){var a=n.defer(),i=t.getURLStr([["reportId",r],["token",o.getToken()]]);return e.get(t.baseUrl+"report/public/delete?"+i).success(function(e){console.log("删除专业测评"),"SUCCEED"==e.callStatus?a.resolve(e.data):alert("删除失败")}).error(function(e){alert("您好，您访问的内容出错")}),a.promise},this.addCompanyPubReport=function(r){r.token=o.getToken();var a=n.defer();return e.post(t.baseUrl+"report/public/add",r).success(function(e){console.log("添加专业测评"),"SUCCEED"==e.callStatus?a.resolve(e.data):alert("添加失败")}).error(function(e){alert("您好，您访问的内容出错")}),a.promise},this.updateCompanyPubReport=function(r){r.reportId=r._id,r.token=o.getToken();var a=n.defer();return e.post(t.baseUrl+"report/public/modify/detail",r).success(function(e){console.log("修改专业测评"),"SUCCEED"==e.callStatus?a.resolve(e.data):alert("修改失败")}).error(function(e){alert("您好，您访问的内容出错")}),a.promise}}]),angular.module("auto-biz-user").service("CompanyService",["$http","GlobalService","$q","AuthService",function(e,t,n,o){this.registerCompany=function(r){var a=n.defer();return console.log(r),e.post(t.baseUrl+"company/signup",r).success(function(e){console.log("企业注册"),"SUCCEED"==e.callStatus?(o.kickOut(),a.resolve(e.data),o.company=e.data,localStorage.auto_company=JSON.stringify(e.data)):alert(e.errCode)}).error(function(e){alert("您好，您访问的内容出错")}),a.promise},this.modifyCompany=function(r){r.token=o.getToken(),console.log(r);var a=n.defer();return e.post(t.baseUrl+"company/modify/info",r).success(function(e){console.log("修改企业信息"),"SUCCEED"==e.callStatus?a.resolve(e.data):alert("您好，您访问的内容出错")}).error(function(e){alert("您好，您访问的内容出错")}),a.promise},this.getCompanysList=function(r,a,i,s,c){var l=n.defer(),u=t.getURLStr([["isPassed",i],["type",s],["name",c],["token",o.getToken()]]),p=t.baseUrl+"company/list/"+r+"/"+a+"?"+u;return e.get(p).success(function(e){console.log("获取企业列表"),console.log(e),"SUCCEED"==e.callStatus?l.resolve(e.data):alert("您好，您访问的内容出错")}).error(function(e){alert("您好，您访问的内容出错")}),l.promise},this.getCompanyList=function(r,a,i,s,c){var l=n.defer();console.log("读取getCompanyListService网络数据");var u=t.getURLStr([["isPassed",i],["type",s],["name",c]]),p=t.baseUrl+"company/list/"+r+"/"+a+"?";return p+=u,o.user.token&&(p=p+"&token="+o.user.token),console.log(p),e.get(p).success(function(e,t,n,o){console.log(e),"SUCCEED"==e.callStatus?l.resolve(e.data):alert(e.errCode)}).error(function(e,t,n,o){console.log(e)}),l.promise},this.passCompany=function(r,a){var i=o.user.token,s=t.baseUrl+"company/modify/approval?token="+i+"&companyId="+r+"&approvalStatus="+a,c=n.defer();return e.get(s).success(function(e,t,n,o){"SUCCEED"==e.callStatus?(alert("认证成功!"),c.resolve("")):(alert("认证失败"+e.errCode),c.resolve(""))}).error(function(e,t,n,o){c.reject(e)}),c.promise},this.getComppanyById=function(r){var a=n.defer(),i=t.getURLStr([["companyId",r],["token",o.getToken()]]);return e.get(t.baseUrl+"company/detail?"+i).success(function(e){console.log("获取企业信息"),"SUCCEED"==e.callStatus?a.resolve(e.data):alert("您好，您访问的内容出错")}).error(function(e){alert("您好，您访问的内容出错")}),a.promise}}]),angular.module("auto-biz-user").service("FileService",["$q","$http","GlobalService","Upload",function(e,t,n,o){this.uploadFile=function(t){var r=e.defer();return t&&o.upload({url:n.baseUrl+"upload",file:t}).success(function(e){"SUCCEED"==e.callStatus?(console.log("上传文件成功"),r.resolve(e.data)):alert("您好，上传文件失败")}).error(function(){alert("您好，上传文件失败")}),r.promise}}]),angular.module("auto-biz-user").service("GlobalService",["$filter",function(e){this.baseUrl="http://123.56.220.72:3300/",this.MD5Decode=function(e){return e},this.headerList=[{name:"首页",title:"HOME",url:"http://www.auto-biz.cn"},{name:"资讯",title:"NEWS",url:"http://www.auto-biz.cn/toNews.html"},{name:"对话",title:"DIALOGUE",url:"http://www.auto-biz.cn/toTalks.html"},{name:"数据",title:"DATA",url:"http://www.auto-biz.cn/toData.html"},{name:"专栏",title:"COLUMNS",url:"http://www.auto-biz.cn/authors.html"},{name:"品车",title:"CARS",url:"http://www.auto-biz.cn/toTaste.html"},{name:"投稿",title:"CT",url:"http://www.auto-biz.cn/contribute.html"},{name:"企业平台",title:"INNOVATION",url:"/innovation"}],this.companyType=[{name:"汽车制作",id:"CM"},{name:"汽车零部件",id:"CG"},{name:"汽车销售与服务",id:"CS"},{name:"新能源汽车",id:"NEC"},{name:"车联网",id:"NOC"},{name:"车用化工品",id:"CC"},{name:"汽车金融",id:"CE"},{name:"公共交通",id:"PT"},{name:"汽车媒体",id:"MOC"}],this.investType=[{name:"A轮",id:"A"},{name:"B轮",id:"B"}],this.testStatus=[{name:"已结束",id:"0"},{name:"测评中",id:"1"}],this.testType=[{name:"实地",id:"local"},{name:"邮寄",id:"mail"}],this.innovationTime=[{name:"全部",id:""},{name:"一周内",id:-6048e5},{name:"一个月内",id:-2592e6},{name:"三个月内",id:-7776e6},{name:"一年内",id:-31536e6}],this.innovationList=[["最新资讯","null","innovationNews"],["最新产品","innovationProducts","hotProducts"],["热门测评","innovationTest","hotTest"],["发现企业","innovationCompany","companyDiscover"]],this.cmpDetailList=[["公司概况","companyOutline","outline"],["最新资讯","innovationNews","news"],["最新产品","hotProducts","product"],["热门测评","hotTest","test"],["财务状况","companyFinance","finance"]],this.getURLStr=function(e){for(var t="",n=0;n<e.length;n++)""!=e[n][1]&&(t=""!=t?t+"&"+e[n][0]+"="+e[n][1]:e[n][0]+"="+e[n][1]);return t},this.getDateStr=function(t){var n=new Date;return n=n.setTime(n.getTime()+t),e("date")(n,"yyyy-MM-dd")}}]),angular.module("auto-biz-user").factory("loadingHttpInterceptor",["$q","$timeout",function(e,t){var n=!1;return{request:function(t){return 0==n&&($.isLoading(),n=!0),t||e.when(t)},requestError:function(o){return t(function(){$.isLoading("hide"),n=!1},500),e.reject(rejection)},response:function(o){return t(function(){$.isLoading("hide"),n=!1},500),o||e.when(o)},responseError:function(o){return t(function(){$.isLoading("hide"),n=!1},500),e.reject(o)}}}]),angular.module("auto-biz-user").service("LocationService",["$q","$http","GlobalService",function(e,t,n){this.getProvinceList=function(){var o=e.defer(),r=n.baseUrl+"list/prov";return console.log(r),t.get(r).success(function(e){console.log("获取省份列表"),console.log(e),"SUCCEED"==e.callStatus?o.resolve(e.data):alert("您好，您访问的内容出错")}).error(function(e){alert("您好，您访问的内容出错")}),o.promise},this.getCityListByProvince=function(o){var r=e.defer(),a=n.baseUrl+"list/cityof/"+o;return console.log(a),t.get(a).success(function(e){console.log("获取市级列表"),console.log(e),"SUCCEED"==e.callStatus?r.resolve(e.data):alert("您好，您访问的内容出错")}).error(function(e){alert("您好，您访问的内容出错")}),r.promise},this.getCityByNum=function(o){var r=e.defer(),a=n.baseUrl+"city/detail/"+o;return console.log(a),t.get(a).success(function(e){console.log("获取省市名字"),console.log(e),"SUCCEED"==e.callStatus?r.resolve(e.data):alert("您好，您访问的内容出错")}).error(function(e){alert("您好，您访问的内容出错")}),r.promise}}]),angular.module("auto-biz-user").service("UserHeaderService",function(){console.log("读取userheader数据"),this.headerList=[{name:"首页",title:"HOME",url:""},{name:"资讯",title:"NEWS",url:""},{name:"对话",title:"DIALOGUE",url:""},{name:"数据",title:"DATA",url:""},{name:"专栏",title:"COLUMNS",url:""},{name:"品车",title:"CARS",url:""},{name:"投稿",title:"CT",url:""},{name:"企业平台",title:"INNOVATION",url:""}]}),angular.module("auto-biz-user").service("UserService",["$http","$q","GlobalService","AuthService",function(e,t,n,o){this.registerUser=function(r){var a=t.defer();return e.post(n.baseUrl+"user/signup",r).success(function(e,t,n,r){console.log("注册用户"),"SUCCEED"==e.callStatus?(o.kickOut(),a.resolve(e.data),o.user=e.data,localStorage.auto_user=JSON.stringify(e.data)):"USER_EXIST"==e.errCode?alert("账户名已存在"):alert("注册失败"+e.errCode)}).error(function(e,t,n,o){alert("您好，访问的内容出错")}),a.promise},this.getUserList=function(r,a,i,s){var c=t.defer();console.log("读取getUserListService网络数据");var l=n.baseUrl+"user/list/"+r+"/"+a+"?token="+o.user.token;return""!==i?(l=l+"&isPassed="+i,""!==s&&(l=l+"&nikeName="+s)):""!==s&&(l=l+"?nikeName="+s),console.log(l),e.get(l).success(function(e,t,n,o){console.log(e),"SUCCEED"==e.callStatus?c.resolve(e.data):alert("获取列表失败")}).error(function(e,t,n,o){alert("您好，访问的内容出错")}),c.promise},this.passUser=function(r,a){var i=o.user.token,s=n.baseUrl+"user/modify/approval?token="+i+"&userId="+r+"&approvalStatus="+a,c=t.defer();return e.get(s).success(function(e,t,n,o){"SUCCEED"==e.callStatus?(alert("用户认证成功"),c.resolve("")):alert("用户认证失败")}).error(function(e,t,n,o){alert("您好，访问的内容出错")}),c.promise},this.updateUserType=function(r,a){var i=o.user.token,s=n.baseUrl+"user/modify/type?token="+i+"&userId="+r+"&newType="+a,c=t.defer();return e.get(s).success(function(e,t,n,o){"SUCCEED"==e.callStatus?(alert("用户类型更改成功!"),c.resolve("")):alert("用户类型更改失败")}).error(function(e,t,n,o){alert("您好，访问的内容出错")}),c.promise}}]),angular.module("auto-biz-user").controller("AdminController",["$scope","AuthService","$location",function(e,t,n){console.log("载入AdminController"),e.testShow=!1,e.currentPage="userList",t.user?"admin"!=t.user.userType&&n.path("/admin"):n.path("/admin"),e.toggleTestList=function(){e.testShow=!e.testShow},e.setPage=function(t){e.currentPage=t},e.adminLogout=function(){t.userLogout().then(function(e){n.path("/admin"),alert("退出登录成功")})}}]),angular.module("auto-biz-user").controller("companyListController",["$scope","CompanyService",function(e,t){function n(){var t=[];for(i in e.navList){var n=new Object;n.type=e.navList[i].name,n.current=e.navList[i].optionList[0].name,
t.push(n)}return t}console.log("载入companyListController"),t.getCompanyList(10,1,"","","").then(function(t){console.log(t),e.companyList=t.list,e.currentUser=t.list[0],e.passFlag="",e.companyType="",e.type="",e.pageSize=10,e.total=t.totalNum}),e.navList=[{name:"审核状态",optionList:[{name:"全部",id:""},{name:"已通过",id:"1"},{name:"待审核",id:"0"},{name:"未通过",id:"-1"}]},{name:"行业",optionList:[{name:"全部",id:""},{name:"汽车制造",id:"CM"},{name:"汽车零部件",id:"CG"},{name:"汽车销售与服务",id:"CS"},{name:"新能源汽车",id:"NEC"},{name:"车联网",id:"NOC"},{name:"车用化工品",id:"CC"},{name:"汽车金融",id:"CE"},{name:"PT公共交通",id:"PT"},{name:"汽车媒体",id:"MOC"}]}],e.currentOptionList=n(),e.isCurrentOption=function(t,n){for(i in e.currentOptionList)if(e.currentOptionList[i].type==t&&e.currentOptionList[i].current==n)return!0;return!1},e.setCurrentOption=function(n,o,r){for(i in e.currentOptionList)e.currentOptionList[i].type==n&&(e.currentOptionList[i].current=o.name);console.log(n+o);var a=e.passFlag,s=e.companyType;"审核状态"==n&&(a=o.id),"行业"==n&&(s=o.id),t.getCompanyList(10,1,a,s,r).then(function(t){e.companyList=t.list,e.passFlag=a,e.companyType=s,e.currentPage=1,e.total=t.totalNum})},e.changePage=function(n){t.getCompanyList(10,n,e.passFlag,e.type,"").then(function(t){e.companyList=t.list,e.total=t.totalNum})},e.setCurrentCompany=function(t){e.currentUser=t},e.passUser=function(n,o){t.passCompany(n,o).then(function(n){t.getCompanyList(10,e.currentPage,e.passFlag,e.type,"").then(function(t){e.companyList=t.list,e.total=t.totalNum})})}}]),angular.module("auto-biz-user").controller("companyNewsController",["$scope","CompanyNewsService",function(e,t){function n(){var t=[];for(i in e.navList){var n=new Object;n.type=e.navList[i].name,n.current=e.navList[i].optionList[0].name,t.push(n)}return t}console.log("载入companyNewsController"),t.getCompanyNewsList("","","","","","","","",10,1).then(function(t){e.newsList=t.list,e.currentNews=t.list[0],e.passFlag="",e.companyType="",e.pageSize=10,e.total=t.totalNum}),e.navList=[{name:"上线状态",optionList:[{name:"全部",id:""},{name:"上线",id:"true"},{name:"下线",id:"false"}]},{name:"标签",optionList:[{name:"全部",id:""},{name:"汽车制造",id:"CM"},{name:"汽车零部件",id:"CG"},{name:"汽车销售与服务",id:"CS"},{name:"新能源汽车",id:"NEC"},{name:"车联网",id:"NOC"},{name:"车用化工品",id:"CC"},{name:"汽车金融",id:"CE"},{name:"PT公共交通",id:"PT"},{name:"汽车媒体",id:"MOC"}]}],e.currentOptionList=n(),e.isCurrentOption=function(t,n){for(i in e.currentOptionList)if(e.currentOptionList[i].type==t&&e.currentOptionList[i].current==n)return!0;return!1},e.getCompanyNewsList=function(n,o,r){for(i in e.currentOptionList)e.currentOptionList[i].type==n&&(e.currentOptionList[i].current=o.name);console.log(n+o);var a=e.passFlag,s=e.companyType;"上线状态"==n&&(a=o.id),"标签"==n&&(s=o.id),t.getCompanyNewsList(r,"","",s,a,"","","",10,1).then(function(t){e.newsList=t.list,e.passFlag=a,e.companyType=s,e.currentPage=1,e.total=t.totalNum})},e.setCurrentNews=function(n){t.getCompanyNewsDetail(n).then(function(t){e.currentNews=t})},e.setNewsState=function(n,o){t.changeCompanyNewsStateAdmin(n,o).then(function(n){t.getCompanyNewsList("","","",e.companyType,e.passFlag,"","","",10,e.currentPage).then(function(t){e.newsList=t.list,e.total=t.totalNum})})},e.changePage=function(n){t.getCompanyNewsList("","","",e.companyType,e.passFlag,"","","",10,n).then(function(t){e.newsList=t.list,e.total=t.totalNum})}}]),angular.module("auto-biz-user").controller("companyPriReportController",["$scope","CompanyService","CompanyPriReportService",function(e,t,n){function o(){var t=[];for(i in e.navList){var n=new Object;n.type=e.navList[i].name,n.current=e.navList[i].optionList[0].name,t.push(n)}return t}function r(t,o){n.getReportSignUser(t,o).then(function(t){e.signUserList=t,console.log(t)})}function a(t,o){n.getReportPassUser(t,o).then(function(t){e.passUserList=t,console.log(t)})}console.log("载入companyPriReportController"),n.getCompanyPriReportList("","","","","","","","","","","","","","","","","",10,1).then(function(t){e.priReportList=t.list,e.currentPriReport=t.list[0],e.passFlag="",e.pageSize=10,e.total=t.totalNum}),e.navList=[{name:"审核状态",optionList:[{name:"全部",id:""},{name:"已通过",id:"1"},{name:"待审核",id:"0"},{name:"未通过",id:"-1"}]}],e.currentOptionList=o(),e.isCurrentOption=function(t,n){for(i in e.currentOptionList)if(e.currentOptionList[i].type==t&&e.currentOptionList[i].current==n)return!0;return!1},e.getCompanyPriReportList=function(t,o,r){console.log(r);for(i in e.currentOptionList)e.currentOptionList[i].type==t&&(e.currentOptionList[i].current=o.name);console.log(t+o);var a=e.passFlag;"审核状态"==t&&(a=o.id),n.getCompanyPriReportList("",r,"","","","","","","","","",a,"","","","","",10,1).then(function(t){e.priReportList=t.list,e.passFlag=a,e.currentPage=1,e.total=t.totalNum})},e.setCurrentPriReport=function(t){e.currentPriReport=t},e.getSignUser=function(t){e.currentPriReport=t,r(t._id,"")},e.getUserList=function(t){r(e.currentPriReport._id,t)},e.getPassUser=function(t){e.currentPriReport=t,a(t._id,"")},e.getPassUserList=function(t){a(e.currentPriReport._id,t)},e.approveUser=function(t){console.log(t),n.passCompanyPriReport(e.currentPriReport._id,t.signUser.userId[0]._id,1).then(function(e){console.log(e),t.signUser.passed="1"})},e.denyUser=function(t){console.log(t),console.log("no"),n.passCompanyPriReport(e.currentPriReport._id,t.signUser.userId[0]._id,-1).then(function(e){console.log(e),t.signUser.passed="-1"})},e.approveComment=function(t){console.log(t),n.passCommentCompanyPriReport(e.currentPriReport._id,t.passUser.userId[0]._id,1).then(function(e){console.log(e),t.signUser.passed="1"})},e.denyComment=function(t){n.passCommentCompanyPriReport(e.currentPriReport._id,t.passUser.userId[0]._id,-1).then(function(e){console.log(e),t.signUser.passed="-1"})},e.passPriReport=function(t,o){n.changeCompanyPriReportState(t,o).then(function(t){n.getCompanyPriReportList("","","","","","","","","","","",e.passFlag,"","","","","",10,e.currentPage).then(function(t){e.priReportList=t.list,e.total=t.totalNum})})},e.setPriReport=function(t,o){n.changeCompanyPriReportOnlineAdmin(t,o).then(function(t){n.getCompanyPriReportList("","","","","","","","","","","",e.passFlag,"","","","","",10,e.currentPage).then(function(t){e.priReportList=t.list,e.total=t.totalNum})})},e.max=5,e.onHover=function(t){e.hoverVal=t},e.onLeave=function(){e.hoverVal=null},e.onChange=function(t){e.ratingVal=t}}]),angular.module("auto-biz-user").controller("companyProductController",["$scope","CompanyProductsService",function(e,t){function n(){var t=[];for(i in e.navList){var n=new Object;n.type=e.navList[i].name,n.current=e.navList[i].optionList[0].name,t.push(n)}return t}console.log("载入companyProductController"),t.getCompanyProductsList("","","","","","","","",10,1).then(function(t){e.productsList=t.list,e.currentProducts=t.list[0],e.passFlag="",e.companyType="",e.pageSize=10,e.total=t.totalNum}),e.navList=[{name:"上线状态",optionList:[{name:"全部",id:""},{name:"上线",id:"true"},{name:"下线",id:"false"}]},{name:"标签",optionList:[{name:"全部",id:""},{name:"汽车制造",id:"CM"},{name:"汽车零部件",id:"CG"},{name:"汽车销售与服务",id:"CS"},{name:"新能源汽车",id:"NEC"},{name:"车联网",id:"NOC"},{name:"车用化工品",id:"CC"},{name:"汽车金融",id:"CE"},{name:"PT公共交通",id:"PT"},{name:"汽车媒体",id:"MOC"}]}],e.currentOptionList=n(),e.isCurrentOption=function(t,n){for(i in e.currentOptionList)if(e.currentOptionList[i].type==t&&e.currentOptionList[i].current==n)return!0;return!1},e.getCompanyproductsList=function(n,o,r){for(i in e.currentOptionList)e.currentOptionList[i].type==n&&(e.currentOptionList[i].current=o.name);var a=e.passFlag,s=e.companyType;"上线状态"==n&&(a=o.id),"标签"==n&&(s=o.id),t.getCompanyProductsList(r,s,a,"","","","","",10,1).then(function(t){e.productsList=t.list,e.passFlag=a,e.companyType=s,e.currentPage=1,e.total=t.totalNum})},e.setCurrentProduct=function(t){e.currentProduct=t},e.setProductState=function(n,o){t.changeCompanyProductsStateAdmin(n,o).then(function(n){t.getCompanyProductsList("",e.companyType,e.passFlag,"","","","","",10,e.currentPage).then(function(t){e.productsList=t.list,e.total=t.totalNum})})},e.changePage=function(n){t.getCompanyProductsList("",e.companyType,e.passFlag,"","","","","",10,n).then(function(t){e.productsList=t.list,e.total=t.totalNum})}}]),angular.module("auto-biz-user").controller("companyPubReportController",["$scope","CompanyPubReportService",function(e,t){function n(){var t=[];for(i in e.navList){var n=new Object;n.type=e.navList[i].name,n.current=e.navList[i].optionList[0].name,t.push(n)}return t}console.log("载入companyPubReportController"),t.getCompanyPubReportList("","","","","","","","",10,1).then(function(t){e.pubReportList=t.list,e.currentPubReport=t.list[0],e.passFlag="",e.pageSize=10,e.total=t.totalNum}),e.navList=[{name:"上线状态",optionList:[{name:"全部",id:""},{name:"上线",id:"true"},{name:"下线",id:"false"}]}],e.currentOptionList=n(),e.isCurrentOption=function(t,n){for(i in e.currentOptionList)if(e.currentOptionList[i].type==t&&e.currentOptionList[i].current==n)return!0;return!1},e.getCompanyPubReportList=function(n,o,r){for(i in e.currentOptionList)e.currentOptionList[i].type==n&&(e.currentOptionList[i].current=o.name);var a=e.passFlag;"上线状态"==n&&(a=o.id),t.getCompanyPubReportList(r,a,"","","","","","",10,1).then(function(t){e.pubReportList=t.list,e.passFlag=a,e.currentPage=1,e.total=t.totalNum})},e.setCurrentPubReport=function(t){e.currentPubReport=t},e.setPubReportState=function(n,o){t.changeCompanyPubReportStateAdmin(n,o).then(function(n){t.getCompanyPubReportList("",e.passFlag,"","","","","","",10,e.currentPage).then(function(t){e.pubReportList=t.list,e.total=t.totalNum})})},e.changePage=function(n){t.getCompanyPubReportList("",e.passFlag,"","","","","","",10,n).then(function(t){e.pubReportList=t.list,e.total=t.totalNum})}}]),angular.module("auto-biz-user").controller("userListController",["$scope","UserService",function(e,t){function n(){var t=[];for(i in e.navList){var n=new Object;n.type=e.navList[i].name,n.current=e.navList[i].optionList[0].name,t.push(n)}return t}console.log("载入userListController"),t.getUserList(10,1,"","").then(function(t){e.userList=t.list,e.type="",e.pageSize=10,e.total=t.totalNum}),e.navList=[{name:"审核状态",optionList:[{name:"全部",id:""},{name:"已通过",id:"1"},{name:"待审核",id:"0"},{name:"未通过",id:"-1"}]}],e.currentOptionList=n(),e.isCurrentOption=function(t,n){for(i in e.currentOptionList)if(e.currentOptionList[i].type==t&&e.currentOptionList[i].current==n)return!0;return!1},e.getlist=function(n,o){for(i in e.currentOptionList)e.currentOptionList[i].type==n&&(e.currentOptionList[i].current=o);t.getUserList(10,1,o,"").then(function(t){e.userList=t.list,e.type=o,e.currentPage=1,e.total=t.totalNum})},e.setCurrentUser=function(t){e.currentUser=t},e.passUser=function(n,o){t.passUser(n,o).then(function(n){t.getUserList(10,e.currentPage,e.type,"").then(function(t){e.userList=t.list,e.total=t.totalNum})})},e.updateUserType=function(n,o){t.updateUserType(n,o).then(function(n){t.getUserList(10,e.currentPage,e.type,"").then(function(t){e.userList=t.list,e.total=t.totalNum})})},e.changePage=function(n){t.getUserList(10,n,e.type,"").then(function(t){e.userList=t.list,e.total=t.totalNum})},e.searchUser=function(n){t.getUserList(10,1,"",n).then(function(t){e.userList=t.list,e.currentPage=1,e.total=t.totalNum})}}]),angular.module("auto-biz-user").controller("CompanyBasicInfoController",["$scope","CompanyService","GlobalService","FileService","LocationService",function(e,t,n,o,r){function a(){t.getComppanyById(e.cmpId).then(function(t){e.infoList=t,e.ctype=s(e.infoList.type),r.getCityByNum(e.infoList.address).then(function(t){e.cityName=t.shi,e.cityNum=t.no,e.provinceName=t.sheng})})}function s(t){for(i in e.ctypeList)if(t==e.ctypeList[i].id)return e.ctypeList[i]}function c(t){for(i in e.provinceList)if(e.provinceList[i].name==t)return e.provinceList[i]}function l(t){for(i in e.cityList)if(e.cityList[i].no==t)return e.cityList[i]}console.log("CompanyBasicInfoController"),$("#form_datetime").datetimepicker({format:"YYYY/MM/DD",locale:moment.locale("zh-cn")}),e.infoList={},e.isEdit=!1,e.infoList_backup=null,e.ctypeList=n.companyType,r.getProvinceList().then(function(t){e.provinceList=t}),e.getCityList=function(t){console.log(t),r.getCityListByProvince(t.name).then(function(t){e.cityList=t})},a(),e.startEdit=function(){e.infoList_backup=u(e.infoList),e.isEdit=!0,e.fileLogo=e.infoList_backup.logo,e.province=c(e.provinceName),r.getCityListByProvince(e.province.name).then(function(t){e.cityList=t,e.city=l(e.cityNum)}),console.log(e.infoList),document.getElementById("form_datetime").value=e.infoList.regTime},e.cancelEdit=function(){e.infoList=u(e.infoList_backup),e.isEdit=!1},e.saveEdit=function(){e.infoList.type=e.ctype.id,e.infoList.regTime=document.getElementById("form_datetime").value,e.infoList.address=e.city.no,console.log(e.infoList),t.modifyCompany(e.infoList).then(function(e){a()}),e.isEdit=!1};var u=function(e){var t={};e instanceof Array&&(t=[]);for(var n in e){var o=e[n];t[n]="object"==typeof o?u(o):o}return t};e.uploadLogo=function(t){t&&(e.fileLogo=t,o.uploadFile(t).then(function(t){e.infoList.logo=t.urls[0]}))}}]),angular.module("auto-biz-user").controller("CompanyFinanceMngController",["$scope","CompanyFinanceService",function(e,t){function n(){o(e.pageSize,1)}function o(n,o){t.getCompanyFinanceList(e.cmpId,"","",n,o).then(function(t){e.financeList=t.list,console.log(e.financeList),e.currentPage=t.currentPage,e.total=t.totalNum})}function r(){var t=!0;return a(e.winMoney)||(e.invalidWinMoney=!0,t=!1),s(e.year)||(e.invalidYear=!0,t=!1),t}function a(e){return""!=e}function s(t){for(i in e.financeList)if(t==e.financeList[i].year)return!1;return!0}function c(){e.invalidYear=!1,e.invalidWinMoney=!1,e.year="",e.winRate="",e.winMoney="",e.winMoneyRate="",e.totalProperty="",e.trueProperty="",e.grossProfitRate="",e.netProfitRate="",e.assetLiabilityRatio="",e.returnOnAssets=""}console.log("CompanyFinanceMngController"),e.tmpItem={},e.pageSize=50,e.currentPage=1,e.cmpId=e.leafCmpId,n(),e.addFinance=function(){r()&&(financeItem=new Object,financeItem.year=e.year,financeItem.ratio=e.winRate,financeItem.input=e.winMoney,financeItem.increase=e.winMoneyRate,financeItem.allCapital=e.totalProperty,financeItem.realCapital=e.trueProperty,financeItem.allRatio=e.grossProfitRate,financeItem.realRatio=e.netProfitRate,financeItem.debtRatio=e.assetLiabilityRatio,financeItem.inputRatio=e.returnOnAssets,t.addCompanyFinance(financeItem).then(function(t){n(),c(),e.showAddPanel=!1}))},e.addNewFinance=function(){c(),e.showAddPanel=!0},e.cancelAdd=function(){c(),e.showAddPanel=!1},e.editPastFinance=function(t){e.tmpItem=t,e.tmpItem.hideEdit=!1},e.cancelEditPastFinance=function(t){e.tmpItem=t,e.tmpItem.hideEdit=!0,n()},e.savePastFinance=function(o){return console.log(o),e.tmpItem=o,e.tmpItem.hideEdit=!0,a(e.tmpItem.money)?void t.modifyCompanyFinance(o).then(function(e){n()}):(console.log("钱不对"),!1)},e.deletePastFinance=function(t){e.deleteFinance=t},e.confirmDelete=function(){t.deleteCompanyFinance(e.deleteFinance._id).then(function(e){n()})}}]),angular.module("auto-biz-user").controller("CompanyHeaderController",["$scope",function(e){console.log("CompanyHeaderController")}]),angular.module("auto-biz-user").controller("CompanyMainController",["$scope","AuthService","$location",function(e,t,n){function o(){t.company?(console.log(t.company),e.cmpId=t.company._id,e.leafCmpId=t.company._id,e.companyLogo=t.company.logo,e.companyName=t.company.longName):alert("Invalid User")}console.log("CompanyMainController"),t.company?(e.currentPage="companyBasicInfo",e.toPage=function(t){e.currentPage=t},o()):n.path("/loginCompany")}]),angular.module("auto-biz-user").controller("CompanyNewsMngController",["$scope","CompanyNewsService","FileService",function(e,t,n){function o(){r(e.pageSize,1)}function r(n,o){console.log("readData"),console.log(e.searchStr),t.getCompanyNewsList(e.searchStr,"","","","",e.cmpId,"","",n,o).then(function(t){e.cmpNewsList=t.list,e.currentPage=t.currentPage,e.total=t.totalNum})}function a(){console.log("上传，可能需要刷新表单。");var n=new Object;n.pic=e.imgUrl,n.title=e.addNewsTheme,n.author=e.addNewsAuthor,n.tag=e.addNewsLabel,n.desc=e.addNewsShortCut,n.wysiwyg=e.tmpNews.ueditor,n.isFirst=e.addNewsOption,console.log(n),t.addCompanyNews(n).then(function(e){console.log(e),o()})}function i(){t.updateCompanyNews(e.tmpNews).then(function(e){o()})}console.log("CompanyNewsMngController"),e.pageSize=5,e.tmpNews={},e.searchStr="",e.currentPage=1,e.cmpId=e.leafCmpId,o(),e.confirm=function(e,t,n){e&&a(),n&&i()},e.cancel=function(t,n,o){t&&e.cancelAdd(),o&&e.cancelAdd()},e.uploadThumb=function(t){console.log("1"),t&&(e.fileLogo=t,n.uploadFile(t).then(function(t){e.imgUrl=t.urls[0]}))},e.cancelAdd=function(){e.addNewsTheme="",e.addNewsAuthor="",e.addNewsOption1=!1,e.addNewsOption2=!1,e.addNewsLabel="",e.addNewsShortCut="",e.addNewshtmlVariable="",e.fileLogo=null},e.deleteNews=function(t){e.deleteNews=t},e.confirmDelete=function(){t.deleteCompanyNews(e.deleteNews._id).then(function(e){o()})},e.cancelDelete=function(){e.deleteID=null},e.changeNewsStatus=function(e){t.changeCompanyNewsState(e._id,!e.isOnline).then(function(t){e.isOnline=!e.isOnline})},e.btnAddNews=function(){e.cancelAdd(),e.addModal=!0,e.lookModal=!1,e.editModal=!1},e.btnLookNews=function(n){e.addModal=!1,e.lookModal=!0,e.editModal=!1,t.getCompanyNewsDetail(n._id).then(function(t){e.tmpNews=t,e.fileLogo=e.tmpNews.pic})},e.btnEditNews=function(n){e.addModal=!1,e.lookModal=!1,e.editModal=!0,t.getCompanyNewsDetail(n._id).then(function(t){e.tmpNews=t,e.fileLogo=e.tmpNews.pic})},e.btnSearch=function(){e.currentPage=1,o()},e.changePage=function(t){r(e.pageSize,t)}}]),angular.module("auto-biz-user").controller("CompanyProductMngController",["$scope","FileService","CompanyProductsService","GlobalService","$filter",function(e,t,n,o,r){function a(){s(e.pageSize,e.currentPage)}function s(t,o){n.getCompanyProductsList(e.searchStr,"","","","",e.cmpId,"","",t,o).then(function(t){e.productList=t.list,e.currentPage=t.currentPage,e.total=t.totalNum})}function c(t){for(i in e.ctypeList)if(t==e.ctypeList[i].id)return e.ctypeList[i]}function l(t){for(i in e.ctypeList)if(t==e.ctypeList[i].name)return e.ctypeList[i].id}function u(){productItem=new Object,productItem.name=e.addProductName,productItem.images=e.images,productItem.tag=e.addSelectedTags.id,productItem.argc=e.addProductConf,productItem.version=e.addProductVersion,productItem.model=e.addProductModel,productItem.desc=e.addProductShortCut,productItem.releaseDate=document.getElementById("form_datetime").value,n.addCompanyProduct(productItem).then(function(e){a()})}function p(){e.tmpProduct.releaseDate=document.getElementById("form_datetime2").value,e.tmpProduct.tag=l(e.cmpType.name),console.log(e.tmpProduct),n.updateCompanyProduct(e.tmpProduct).then(function(e){a()})}function m(){e.addProductName="",e.images=[],e.addSelectedTags="",e.addProductConf="",e.addProductShortCut="",e.addProductVersion="",e.addProductModel="",document.getElementById("form_datetime").value=null}console.log("CompanyProductMngController"),$("#form_datetime").datetimepicker({format:"YYYY/MM/DD",locale:moment.locale("zh-cn")}),$("#form_datetime2").datetimepicker({format:"YYYY/MM/DD",locale:moment.locale("zh-cn")}),e.tmpProduct={},e.companyName="小软酱有限公司",e.deleteID="",e.ctypeList=o.companyType,e.searchStr="",e.currentPage=1,e.pageSize=5,e.cmpId=e.leafCmpId,a(),e.btnSearch=function(){e.currentPage=1,a()},e.changePage=function(t){s(e.pageSize,t)},e.confirm=function(e,t,n){e&&(u(),m()),n&&p()},e.cancel=function(e,t,n){e&&m()},e.deleteProduct=function(t){e.deleteProduct=t},e.confirmDelete=function(){n.deleteCompanyProduct(e.deleteProduct._id).then(function(e){a()})},e.cancelDelete=function(){e.deleteProduct=null},e.changeProductStatus=function(e){console.log("1"),console.log(e),n.changeCompanyProductsState(e._id,!e.state).then(function(t){e.state=!e.state,console.log("2"),console.log(e)})},e.btnAddProduct=function(){e.addModal=!0,e.lookModal=!1,e.editModal=!1},e.btnLookProduct=function(t){e.addModal=!1,e.lookModal=!0,e.editModal=!1,n.getCompanyProductsDetail(t._id).then(function(t){e.tmpProduct=t})},e.btnEditProduct=function(t){e.addModal=!1,e.lookModal=!1,e.editModal=!0,n.getCompanyProductsDetail(t._id).then(function(t){console.log(t),e.tmpProduct=t,e.cmpType=c(e.tmpProduct.tag),document.getElementById("form_datetime2").value=r("date")(e.tmpProduct.releaseDate,"yyyy/MM/dd")})},e.images=[],e.upload=function(n){n&&t.uploadFile(n).then(function(t){var n=t.urls[0];e.images.push(n)})},e.delete_thumb=function(t){for(i in e.images)e.images[i]==t&&e.images.splice(i,1)},e.uploadWhenEdit=function(n){n&&t.uploadFile(n).then(function(t){var n=t.urls[0];e.tmpProduct.images.push(n)})},e.delete_thumb_edit=function(t){for(i in e.tmpProduct.images)e.tmpProduct.images[i]==t&&e.tmpProduct.images.splice(i,1)}}]),angular.module("auto-biz-user").controller("CompanySideBarController",["$scope",function(e){console.log("CompanySideBarController"),e.testShow=!1,e.toggleTestList=function(){e.testShow=!e.testShow}}]),angular.module("auto-biz-user").controller("CompanyTestController",["$scope","FileService","CompanyPubReportService","CompanyProductsService","$filter",function(e,t,n,o,r){function a(){s(e.pageSize,e.currentPage),c()}function s(t,o){n.getCompanyPubReportList("","","",e.searchStr,"",e.cmpId,"","",t,o).then(function(t){e.testList=t.list,e.currentPage=t.currentPage,e.total=t.totalNum})}function c(){var t=1,n=1;o.getCompanyProductsList("","","","","",e.cmpId,"","",n,t).then(function(r){n=r.totalNum,o.getCompanyProductsList("","","","","",e.cmpId,"","",n,t).then(function(t){e.productList=t.list})})}function l(){var t=new Object;t.productId=e.addTestProduct._id,t.date=document.getElementById("form_datetime").value,t.team=e.addTestTeam,t.site=e.addTestAddress,t.report=e.fileUrl,n.addCompanyPubReport(t).then(function(e){a()})}function u(){e.addTestProduct=null,document.getElementById("form_datetime").value=null,e.addTestTeam=null,e.addTestAddress=null,e.fileUrl=null}function p(){var t=document.getElementById("form_datetime2").value;t=new Date(Date.parse(t)),e.tmpTest.date=t.getTime(),n.updateCompanyPubReport(e.tmpTest).then(function(e){a()})}function m(t){for(i in e.productList)if(e.productList[i]._id==t)return e.productList[i]}console.log("CompanyTestController"),e.tmpTest={},e.companyName="小软酱有限公司",e.deleteID="",$("#form_datetime").datetimepicker({format:"YYYY/MM/DD",locale:moment.locale("zh-cn")}),$("#form_datetime2").datetimepicker({format:"YYYY/MM/DD",locale:moment.locale("zh-cn")}),e.searchStr="",e.currentPage=1,e.pageSize=5,e.cmpId=e.leafCmpId,a(),e.changePage=function(t){s(e.pageSize,t)},e.btnSearch=function(){e.currentPage=1,a()},e.confirm=function(e){"addModal"==e&&(l(),u()),"editModal"==e&&p()},e.cancel=function(e){"addModal"==e&&u()},e.btnDownloadTest=function(e){var t=document.createElement("a"),n=e.report,o=n.indexOf("upload_"),r=n.substring(o);t.href=n,t.download=r,t.click()},e.btnDeleteTest=function(t){e.deleteTest=t},e.confirmDelete=function(){n.deleteCompanyPubReport(e.deleteTest._id).then(function(e){a()})},e.cancelDelete=function(){e.deleteTest=null},e.btnEditTest=function(t){e.setModalStatus("editModal"),n.getCompanyPubReportDetail(t.productId._id).then(function(t){e.tmpTest=t.list[0],e.tmpProduct=m(e.tmpTest.productId._id),document.getElementById("form_datetime2").value=r("date")(e.tmpTest.date,"yyyy/MM/dd")})},e.setModalStatus=function(t){e.modalStatus=t},e.upload=function(n){n&&t.uploadFile(n).then(function(t){e.fileUrl=t.urls[0]})},e.uploadWhenEdit=function(n){n&&t.uploadFile(n).then(function(t){e.tmpTest.report=t.urls[0]})}}]),angular.module("auto-biz-user").controller("CompanyUserTestController",["$scope","FileService","CompanyPriReportService","CompanyProductsService","$filter",function(e,t,n,o,r){function a(){c(e.pageSize,e.currentPage)}function s(t){for(i in e.productList)if(e.productList[i]._id==t)return e.productList[i].name}function c(t,o){n.getCompanyPriReportList("",e.searchStr,"","","","","","","","","","","","","","",e.cmpId,t,o).then(function(t){e.userTestList=t.list,e.currentPage=t.currentPage,e.total=t.totalNum,l()})}function l(){var t=1,n=1;o.getCompanyProductsList("","","","","",e.cmpId,"","",n,t).then(function(r){n=r.totalNum,o.getCompanyProductsList("","","","","",e.cmpId,"","",n,t).then(function(t){e.productList=t.list})})}function u(){console.log(e.addType);var t=new Object;t.productId=e.addTestProduct._id,t.title=e.addUserTestTitle,t.dateStart=document.getElementById("form_datetimeStart").value,t.dateEnd=document.getElementById("form_datetimeEnd").value,t.type=r("testTypeFilter")(e.addType),t.address=e.addUserTestAddress,t.argc=e.addTagList,t.maxUserNum=Number(e.addUserTestPeople),t.images=e.imgList,console.log(t),n.addCompanyPriReport(t).then(function(e){a()})}function p(){e.addTestProduct=null,e.addUserTestTitle=null,e.addUserTestAddress=null,e.addType=null,e.addTagList=[],e.addUserTestPeople=null,e.imgList=[]}console.log("CompanyUserTestController"),e.tmpUserTest={},e.companyName="小软酱有限公司",e.deleteID="",$("#form_datetimeStart").datetimepicker({format:"YYYY/MM/DD",locale:moment.locale("zh-cn")}),$("#form_datetimeEnd").datetimepicker({format:"YYYY/MM/DD",locale:moment.locale("zh-cn")}),e.searchStr="",e.currentPage=1,e.pageSize=5,e.cmpId=e.leafCmpId,a(),e.getName=function(e){return s(e)},e.changePage=function(t){c(e.pageSize,t)},e.btnSearch=function(){e.currentPage=1,a()},e.confirm=function(e){"addModal"==e&&(u(),p())},e.cancel=function(e){"addModal"==e&&p()},e.setModalStatus=function(t){e.modalStatus=t},e.imgList=[],e.upload=function(n){n&&t.uploadFile(n).then(function(t){var n=t.urls[0];e.imgList.push(n)})},e.delete_thumb=function(t){for(i in e.imgList)e.imgList[i]==t&&e.imgList.splice(i,1)},e.btnLookUserTest=function(t){e.setModalStatus("lookModal"),console.log(t.productId),n.getCompanyPriReportDetail(t._id).then(function(t){e.tmpUserTest=t})},e.btnDeleteUserTest=function(t){e.deleteUserTest=t},e.confirmDelete=function(){n.deleteCompanyPriReport(e.deleteUserTest._id).then(function(e){a()})},e.cancelDelete=function(){e.deleteUserTest=null},e.addTagList=[],e.newTag=function(){e.tmpTagName=""},e.confirmNewTag=function(){console.log("tmpTagName"),e.addTagList.push(e.tmpTagName),console.log(e.addTagList),e.tmpTagName="",console.log(e.addTagList)},e.cancelNewTag=function(){e.tmpTagName=""},e.deleteTag=function(t){for(i in e.addTagList)t==e.addTagList[i]&&e.addTagList.splice(i,1)},e.btnShowParticipant=function(t){console.log(t),n.getCompanyPriReportDetail(t._id).then(function(t){e.nowUserTest=t,n.getReportPassUser(e.nowUserTest._id,"1").then(function(t){console.log(t),e.testedList=t})}),e.currentTab="testedUser"},e.toTab=function(t){e.currentTab=t,"testingUser"==e.currentTab?n.getReportPassUser(e.nowUserTest._id,"0").then(function(t){console.log(t),e.testingList=t}):"passedUser"==e.currentTab?n.getReportSignUser(e.nowUserTest._id,"1").then(function(t){console.log(t),e.passList=t}):"signUser"==e.currentTab?n.getReportSignUser(e.nowUserTest._id,"0").then(function(t){console.log(t),e.signList=t}):"testedUser"==e.currentTab&&n.getReportPassUser(e.nowUserTest._id,"1").then(function(t){console.log(t),e.testedList=t})},e.max=5,e.readonly=!0,e.onHover=function(t){e.hoverVal=t},e.onLeave=function(){e.hoverVal=null},e.onChange=function(t){e.ratingVal=t}}]),angular.module("auto-biz-user").controller("AuthController",["$scope","AuthService","UserService","$location","FileService",function(e,t,n,o,r){console.log("载入AuthController"),e.userType=[["普通用户","normal"],["专栏作者","wr"]],e.regUserType=e.userType[0],e.user={idImg1:"",idImg2:""},e.clickLoginUser=function(){console.log(e.user),t.userLogin(e.user.name,e.user.password).then(function(){o.path("/innovation")})},e.clickLoginAdmin=function(){t.userLogin(e.user.name,e.user.password).then(function(e){"admin"==e.userType?o.path("/adminPage"):(alert("权限不足，请重新登录"),t.userLogout())})},e.uploadFirPic=function(t){t&&r.uploadFile(t).then(function(n){e.user.idImg1=n.urls[0],e.firpic=t})},e.uploadSecPic=function(t){t&&r.uploadFile(t).then(function(n){e.user.idImg2=n.urls[0],e.secpic=t})},e.clickRegisterUser=function(){return e.user.userType=e.regUserType[1],console.log(e.user),e.user.name&&""!=e.user.name?e.user.nikeName&&""!=e.user.nikeName?e.user.password&&""!=e.user.password?e.user.password!=e.user.repass?void alert("两次密码不一致"):void(""==e.user.idImg1||""==e.user.idImg2?alert("请上传用户认证照片"):n.registerUser(e.user).then(function(){o.path("/innovation")})):void alert("请输入密码"):void alert("请输入昵称"):void alert("请输入用户名")},e.clickLoginCompany=function(){console.log(e.cmp),t.companyLogin(e.cmp.cmpName,e.cmp.cmpPass).then(function(e){o.path("/innovation")})}}]),angular.module("auto-biz-user").controller("CompanyCreateController",["$scope","FileService","CompanyService","GlobalService","AuthService","LocationService","$location",function(e,t,n,o,r,a,i){console.log("载入CompanyCreateController"),e.ctypeList=o.companyType,e.cmptype=e.ctypeList[0],e.company={regTime:"",type:"CM"},a.getProvinceList().then(function(t){e.provinceList=t}),e.getCityList=function(t){console.log(t),a.getCityListByProvince(t.name).then(function(t){e.cityList=t})},e.company.type=e.ctypeList[0].id,$("#form_datetime").datetimepicker({format:"YYYY/MM/DD",locale:moment.locale("zh-cn")}),e.uploadLogo=function(n){n&&(e.cmpLogo=n,t.uploadFile(n).then(function(t){e.company.logo=t.urls[0]}))},e.uploadCertificate=function(n){n&&t.uploadFile(n).then(function(t){e.company.info=t.urls[0]})},e.registerCompany=function(){return e.company.type=e.cmptype.id,e.company.regTime=document.getElementById("form_datetime").value,e.city&&(e.company.address=e.city.no||null),e.company.name&&""!=e.company.name?e.company.password&&""!=e.company.password?e.company.password!=e.company.repass?void alert("两次密码不一致"):e.company.position&&""!=e.company.position?e.company.info&&""!=e.company.info?e.company.longName&&""!=e.company.longName?e.company.logo&&""!=e.company.logo?e.company.shortName&&""!=e.company.shortName?e.company.type&&""!=e.company.type?e.company.phone&&""!=e.company.phone?e.company.address&&""!=e.company.address?e.company.field&&""!=e.company.field?e.company.legalEntity&&""!=e.company.legalEntity?e.company.regCapital&&""!=e.company.regCapital?e.company.regTime&&""!=e.company.regTime?null==e.company.regTime||""==e.company.regTime?void alert("请选择是否需要投融资"):void n.registerCompany(e.company).then(function(e){i.path("/innovation")}):void alert("请选择成立时间"):void alert("请输入注册资本"):void alert("请输入法人代表"):void alert("请输入详细地址"):void alert("请选择公司地址"):void alert("请输入联系方式"):void alert("请选择公司类型"):void alert("请输入业务简述"):void alert("请上传公司logo"):void alert("请输入公司名称"):void alert("请上传认证信息"):void alert("请输入注册人职位"):void alert("请输入密码"):void alert("请输入用户名")}}]),angular.module("auto-biz-user").controller("CompanyDetailController",["$scope","GlobalService","CompanyNewsService","$routeParams","CompanyService","CompanyProductsService","CompanyPriReportService","CompanyFinanceService","AuthService","LocationService",function(e,t,n,o,r,a,i,s,c,l){function u(n){e.cmpDetail={list:t.cmpDetailList},"news"==n?(e.currentPage=t.cmpDetailList[1][0],m()):"product"==n?(e.currentPage=t.cmpDetailList[2][0],d()):"test"==n?(e.currentPage=t.cmpDetailList[3][0],g()):"finance"==n?(e.currentPage=t.cmpDetailList[4][0],f()):(e.currentPage=t.cmpDetailList[0][0],p())}function p(){y(3,1),C(3,1),h(3,1),v(1,1)}function m(){y(e.cmpNews.pagePerNum,e.cmpNews.currentPage)}function d(){C(e.cmpProducts.pagePerNum,e.cmpProducts.currentPage)}function g(){h(e.cmpTests.pagePerNum,e.cmpTests.currentPage)}function f(){v(e.cmpFinances.pagePerNum,e.cmpFinances.currentPage)}function y(t,o){n.getCompanyNewsList("","","","","",e.cmpId,"","",t,o).then(function(t){console.log("news"),e.cmpNews.list?e.cmpNews.list=e.cmpNews.list.concat(t.list):e.cmpNews.list=t.list,e.cmpNews.currentPage=t.currentPage,e.cmpNews.totalNum=t.totalNum,e.cmpNews.totalPage=t.totalPageNum})}function C(t,n){a.getCompanyProductsList("","","","","",e.cmpId,"","",t,n).then(function(t){
console.log("products"),e.cmpProducts.list?e.cmpProducts.list=e.cmpProducts.list.concat(t.list):e.cmpProducts.list=t.list,e.cmpProducts.currentPage=t.currentPage,e.cmpProducts.totalNum=t.totalNum,e.cmpProducts.totalPage=t.totalPageNum})}function h(t,n){i.getCompanyPriReportList("","","","","","","","","","","","","","","","",e.cmpId,t,n).then(function(t){console.log("tests"),e.timeNow=(new Date).getTime(),e.cmpTests.list?e.cmpTests.list=e.cmpTests.list.concat(t.list):e.cmpTests.list=t.list,e.cmpTests.currentPage=t.currentPage,e.cmpTests.totalNum=t.totalNum,e.cmpTests.totalPage=t.totalPageNum})}function v(t,n){s.getCompanyFinanceList(e.cmpId,"","",t,n).then(function(t){console.log("finances"),e.cmpFinances.list?e.cmpFinances.list=e.cmpFinances.list.concat(t.list):e.cmpFinances.list=t.list,e.cmpFinances.currentPage=t.currentPage,e.cmpFinances.totalNum=t.totalNum,e.cmpFinances.totalPage=t.totalPageNum})}console.log("CompanyDetailController"),console.log(e),console.log(t),console.log(n),console.log(o),console.log(r),console.log(a),console.log(i),console.log(s),console.log(i),console.log(c),console.log(l),e.cmpId=o.id,r.getComppanyById(e.cmpId).then(function(t){e.companyDetail=t,""!=e.companyDetail.address&&l.getCityByNum(e.companyDetail.address).then(function(t){e.city=t.shi})}),e.cmpDetailList=t.cmpDetailList,e.currentPage=e.cmpDetailList[0][0],e.selectItem=function(t){e.currentPage=t},e.cmpNews={currentPage:1,pagePerNum:10,totalNum:-1,totalPage:-1,list:null},e.cmpProducts={currentPage:1,pagePerNum:6,totalNum:-1,totalPage:-1,list:null},e.cmpTests={currentPage:1,pagePerNum:6,totalNum:-1,totalPage:-1,list:null},e.cmpFinances={currentPage:1,pagePerNum:3,totalNum:-1,totalPage:-1,list:null},u(o.name),e.loadMoreNews=function(){e.cmpNews.currentPage<e.cmpNews.totalPage&&y(e.cmpNews.pagePerNum,e.cmpNews.currentPage+1)},e.loadMoreProducts=function(){e.cmpProducts.currentPage<e.cmpProducts.totalPage&&C(e.cmpProducts.pagePerNum,e.cmpProducts.currentPage+1)},e.loadMoreTests=function(){e.cmpTests.currentPage<e.cmpTests.totalPage&&h(e.cmpTests.pagePerNum,e.cmpTests.currentPage+1)},e.loadMoreFinances=function(){e.cmpFinances.currentPage<e.cmpFinances.totalPage&&v(e.cmpFinances.pagePerNum,e.cmpFinances.currentPage+1)},e.signTest=function(t){e.currentTest=t,e.testImgList=e.currentTest.images},e.testSignTest=function(t,n){return t?(null==n&&(n="暂无"),void("guest"==c.getToken()?alert("用户尚未登录，请注册并且通过审核"):c.company?alert("您现在是企业账号，请以用户身份报名"):c.user&&i.signCompanyPriReport(e.currentTest._id,t,n).then(function(e){alert("申请报名成功，请等待工作人员联系")}))):void alert("请填写手机号")}}]),angular.module("auto-biz-user").controller("CompanyNewsDetailController",["$scope","CompanyNewsService","$routeParams",function(e,t,n){console.log("载入CompanyNewsDetailController"),null!=n.id&&t.getCompanyNewsDetail(n.id).then(function(t){e.newsDetail=t})}]),angular.module("auto-biz-user").controller("CompanyNewsDetailController",["$scope","CompanyNewsService","$routeParams",function(e,t,n){console.log("载入CompanyNewsDetailController"),null!=n.id&&t.getCompanyNewsDetail(n.id).then(function(t){e.newsDetail=t})}]),angular.module("auto-biz-user").controller("CompanyProductDetailController",["$scope","GlobalService","$routeParams","CompanyProductsService","CompanyPubReportService","CompanyPriReportService","AuthService",function(e,t,n,o,r,a,s){function c(e){var t=(new Date).getTime();return!(e>t)}function l(){var t=e.productPriReport.passUser;if(s.user){console.log(s.user);for(i in t)if(s.user._id==t[i].userId)return!0}return!1}function u(e,t){var n=[];for(i in e)0!=t&&(n[i]=e[i]/t);return n}function p(e){var t=0;if(0!=e.length){for(i in e)t+=e[i];return t/e.length}return 0}console.log("载入CompanyProductDetailController"),e.productType=t.companyType,e.newComment={score:[],content:"",reportId:""},e.commentLength=0,e.getStatus=function(t){return t?0==t.isOnline?"offline":0==t.state||t.state==-1?"auditing":c(t.dateStart)?0==e.commentList.length?"noComment":"showComment":"unstart":"noReport"},null!=n.id&&o.getCompanyProductsDetail(n.id).then(function(t){e.productDetail=t,console.log(t),e.productDetail.publicReport&&r.getCompanyPubReportDetail(n.id).then(function(t){e.productPubReport=t.list[0],console.log(t.list[0])}),e.productDetail.privateReport&&(a.getCompanyPriReportDetail(e.productDetail.privateReport).then(function(t){e.productPriReport=t,e.scores=u(e.productPriReport.scores,e.productPriReport.scoredUserNum),e.totalAverageScore=p(e.scores),console.log(t)}),a.getCompanyPriReportComment(e.productDetail.privateReport).then(function(t){e.commentList=t,e.commentLength=e.commentList.length,console.log(t)}))}),e.commitComment=function(){return console.log(e.newComment),l()?(e.newComment.reportId=e.productDetail.privateReport,void a.commentCompanyPriReport(e.newComment).then(function(e){console.log(e)})):void alert("你不是报名用户")},e.max=5,e.onHover=function(t){e.hoverVal=t},e.onLeave=function(){e.hoverVal=null},e.onChange=function(t){e.ratingVal=t}}]),angular.module("auto-biz-user").controller("FooterController",["$scope",function(e){console.log("载入FooterController")}]),angular.module("auto-biz-user").controller("HeaderController",["$scope","GlobalService","$filter","AuthService",function(e,t,n,o){function r(){o.user?e.loginState="user":o.company?e.loginState="cmp":e.loginState=null}console.log("载入HeaderController"),e.headerItems=[{name:"首页",title:"HOME",url:"http://www.auto-biz.cn"},{name:"资讯",title:"NEWS",url:"http://www.auto-biz.cn/toNews.html"},{name:"对话",title:"DIALOGUE",url:"http://www.auto-biz.cn/toTalks.html"},{name:"数据",title:"DATA",url:"http://www.auto-biz.cn/toData.html"},{name:"专栏",title:"COLUMNS",url:"http://www.auto-biz.cn/authors.html"},{name:"品车",title:"CARS",url:"http://www.auto-biz.cn/toTaste.html"},{name:"投稿",title:"CT",url:"http://www.auto-biz.cn/contribute.html"},{name:"企业平台",title:"PLATFORM",url:"/innovation"}],e.currentPage="innovation",r(),e.logout=function(){o.user?o.userLogout().then(function(e){r(),window.location.href="/innovation"}):o.company&&o.companyLogout().then(function(e){r(),window.location.href="/innovation"})}}]),angular.module("auto-biz-user").controller("InnovationController",["$scope","GlobalService","CompanyNewsService","$routeParams","CompanyProductsService","CompanyService","CompanyPriReportService","AuthService","$filter",function(e,t,n,o,r,a,i,s,c){function l(n){e.innovation={list:t.innovationList},"hotProducts"==n?(e.innovation.currentPage=t.innovationList[1][0],m("","",e.cmpProducts.pagePerNum,e.cmpProducts.currentPage)):"hotTest"==n?(e.innovation.currentPage=t.innovationList[2][0],f("","","",e.cmpTests.pagePerNum,e.cmpTests.currentPage)):"companyDiscover"==n?(e.innovation.currentPage=t.innovationList[3][0],d("",e.cmpCompanys.pagePerNum,e.cmpCompanys.currentPage)):(e.innovation.currentPage=t.innovationList[0][0],p(e.cmpNews.pagePerNum,e.cmpNews.currentPage))}function u(){return""==e.cmpProductType[0].current.id?"":t.getDateStr(e.cmpProductType[0].current.id)}function p(t,o){n.getCompanyNewsList("","","","",!0,"","","",t,o).then(function(t){e.cmpNews.list?e.cmpNews.list=e.cmpNews.list.concat(t.list):e.cmpNews.list=t.list,e.cmpNews.currentPage=t.currentPage,e.cmpNews.totalNum=t.totalNum,e.cmpNews.totalPage=t.totalPageNum})}function m(t,n,o,a){r.getCompanyProductsList("",t,"","","","",n,"",o,a).then(function(t){e.cmpProducts.list?e.cmpProducts.list=e.cmpProducts.list.concat(t.list):e.cmpProducts.list=t.list,e.cmpProducts.currentPage=t.currentPage,e.cmpProducts.totalNum=t.totalNum,e.cmpProducts.totalPage=t.totalPageNum})}function d(t,n,o){console.log(t),console.log(n),console.log(o),a.getCompanysList(n,o,1,t,"").then(function(t){e.cmpCompanys.list?e.cmpCompanys.list=e.cmpCompanys.list.concat(t.list):e.cmpCompanys.list=t.list,console.log(e.cmpCompanys.list),e.cmpCompanys.currentPage=t.currentPage,e.cmpCompanys.totalNum=t.totalNum,e.cmpCompanys.totalPage=t.totalPageNum})}function g(){return""==e.cmpTestType[1].current.id?"":t.getDateStr(e.cmpTestType[1].current.id)}function f(t,n,o,r,a){e.timeNow=(new Date).getTime();var s="",l="";"0"==t?(l=c("date")(e.timeNow,"yyyy-MM-dd"),s=""):"1"==t?(s=c("date")(e.timeNow,"yyyy-MM-dd"),l=""):"all"==t&&(s="",l=""),i.getCompanyPriReportList("","",o,"","","",s,l,"","","","1","","",n,"","",r,a).then(function(t){e.cmpTests.list?e.cmpTests.list=e.cmpTests.list.concat(t.list):e.cmpTests.list=t.list,e.cmpTests.currentPage=t.currentPage,e.cmpTests.totalNum=t.totalNum,e.cmpTests.totalPage=t.totalPageNum})}console.log("载入InnovationController"),e.cmpNews={currentPage:1,pagePerNum:10,totalNum:-1,totalPage:-1,list:null},e.cmpProducts={currentPage:1,pagePerNum:6,totalNum:-1,totalPage:-1,list:null},e.cmpTests={currentPage:1,pagePerNum:6,totalNum:-1,totalPage:-1,list:null},e.cmpCompanys={currentPage:1,pagePerNum:5,totalNum:-1,totalPage:-1,list:null},e.timeNow=(new Date).getTime(),e.cmpProductType=[{current:{name:"全部",id:""},name:"时间：",list:t.innovationTime},{current:{name:"全部",id:""},name:"分类：",list:[{name:"全部",id:""}].concat(t.companyType)}],e.cmpCompanyType=[{current:{name:"全部",id:""},name:"类型：",list:[{name:"全部",id:""}].concat(t.companyType)}],e.cmpTestType=[{current:{name:"全部",id:""},name:"状态：",list:[{name:"全部",id:"all"}].concat(t.testStatus)},{current:{name:"全部",id:""},name:"时间：",list:t.innovationTime},{current:{name:"全部",id:""},name:"类型：",list:[{name:"全部",id:""}].concat(t.testType)}],l(o.name),e.loadMoreNews=function(){e.cmpNews.currentPage<e.cmpNews.totalPage&&p(e.cmpNews.pagePerNum,e.cmpNews.currentPage+1)},e.selectCompanyProductsData=function(t,n){e.cmpProductType[t].current=n,e.cmpProducts.list=null,m(e.cmpProductType[1].current.id,u(),e.cmpProducts.pagePerNum,1)},e.loadMoreProducts=function(){e.cmpProducts.currentPage<e.cmpProducts.totalPage&&m(e.cmpProductType[1].current.id,u(),e.cmpProducts.pagePerNum,e.cmpProducts.currentPage+1)},e.selectCompanyCompanysData=function(t,n){e.cmpCompanyType[t].current=n,e.cmpCompanys.list=null,d(e.cmpCompanyType[0].current.id,e.cmpCompanys.pagePerNum,1)},e.loadMoreCompanys=function(){e.cmpCompanys.currentPage<e.cmpCompanys.totalPage&&d(e.cmpCompanyType[0].current.id,e.cmpCompanys.pagePerNum,e.cmpCompanys.currentPage+1)},e.loadMoreTests=function(){e.cmpTests.currentPage<e.cmpTests.totalPage&&f(e.cmpTestType[0].current.id,g(),e.cmpTestType[2].current.id,e.cmpTests.pagePerNum,e.cmpTests.currentPage+1)},e.selectCompanyTestsData=function(t,n){e.cmpTestType[t].current=n,e.cmpTests.list=null,console.log(e.cmpTestType[0].current.id),f(e.cmpTestType[0].current.id,g(),e.cmpTestType[2].current.id,e.cmpTests.pagePerNum,1)},e.signTest=function(t){e.currentTest=t,e.testImgList=e.currentTest.images,e.currentTest.signTestPhone=null,e.currentTest.signTestAddress=null,e.currentTest.address=null},e.testSignTest=function(t,n){return t?(null==n&&(n="暂无"),void("guest"==s.getToken()?alert("用户尚未登录，请注册并且通过审核"):s.company?alert("您现在是企业账号，请以用户身份报名"):s.user&&i.signCompanyPriReport(e.currentTest._id,t,n).then(function(e){alert("申请报名成功，请等待工作人员联系")}))):void alert("请填写手机号")}}]),angular.module("auto-biz-user").controller("MainController",["$scope",function(e){console.log("载入MainController")}]),angular.module("auto-biz-user").directive("star",["$timeout",function(e){return{template:'<ul class="rating" ng-mouseleave="leave()"><li ng-repeat="star in stars" ng-class="star" ng-click="click($index + 1)" ng-mouseover="over($index + 1)">★</li></ul>',scope:{ratingValue:"=",max:"=",readonly:"@",onHover:"=",onLeave:"="},controller:function(e){e.ratingValue=e.ratingValue||0,e.max=e.max||5,e.click=function(t){e.readonly&&"true"===e.readonly||(e.ratingValue=t)},e.over=function(t){e.onHover(t)},e.leave=function(){e.onLeave()}},link:function(e,t,n){t.css("text-align","center");var o=function(){e.stars=[];for(var t=0;t<e.max;t++)e.stars.push({filled:t<e.ratingValue})};o(),e.$watch("ratingValue",function(e,t){t!=e&&o()}),e.$watch("max",function(e,t){t&&o()})}}}]),angular.module("auto-biz-user").directive("headerloginbg",["AuthService",function(e){return{restrict:"A",link:function(t,n){e.company?n.css("background-image","url("+e.company.logo+")"):n.css("background-image","url(/page/project/images/web_header_user.png)")}}}]);